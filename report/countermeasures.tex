In this section we describe practices which we believe are most important to defending against the attacks described in our paper. Implementation and adoption of SSL/TLS is the most important, and basic, step; however, there are other potential countermeasures which we describe here.

\subsection{Security as a Priority}

OpenFlow v1.3.0 and all prior versions list SSL/TLS as an "optional" feature, noting that the switch "may" communicate with the controller using TLS \cite{ietf}. Though previous security analyses have consistently recommended SSL/TLS as a solution to most vulnerabilities, neither controller developers nor hardware manufacturers have implemented SSL/TLS despite these glaring problems. This is in many ways a chicken-and-egg problem. Manufacturers can argue that there is no demand for extra security features; meanwhile, any potential OpenFlow users who need security won't bother with the platform.

Therefore, we recommend that future versions of the specification must include security as a top-level priority, with features such as SSL declared as mandatory, in order for us to have any hope of being able to secure OpenFlow systems. 

\subsection{Verification in the Absence of SSL/TLS}

In the absence of SSL/TLS,  a controller can still attempt to protect itself from deceptive switches. One weakness we saw was that controllers we examined automatically accepted connections with our rogue switch without complaint. This default behavior is extremely dangerous, as any malicious attacker with the controller's IP address can easily connect to the controller and thereby execute any of the attacks from this paper. A controller could mitigate this risk by automatically accepting switch connections only for a short time window after boot; afterwards, new switches would have to be verified or approved by some other mechanism--perhaps a whitelist established by the network administrator, with each switch being assigned some sort of hard-coded datapath ID. However, this approach has the drawback of requiring extra work on the part of the network administrator.

Generally, attempting to verify switch behavior is a good idea, and from a security standpoint, necessary in an OpenFlow world without SSL/TLS. 
The controller should monitor switches' behavior and detect when a switch is behaving oddly. This is an are where machine learning could be extremely useful: algorithms could be trained on historical data, and identify such attacks as they happen. Sudden spikes in the number of new switches, or TCP connections to the controller from suspicious physical locations, should be reported to a network administrator. The suspicious switch could then be quarantined or removed from the network.

Controllers can also raise the bar required for successful rogue switch implementations by doing basic sanity checking on reply messages. For example, requiring replies to have the correct transaction ID is a very basic, but useful step in making switch-faking somewhat more difficult for an adversary to correctly implement.

The controller could also periodically query switches' flow table state to determine if they are behaving correctly. While a switch could of course falsify this state, a requirement to be able to send the ``correct" state on request would mean a significant amount of extra work for the rogue switch. The OpenFlow protocol, however, doesn't make this very straightforward; aggregate flow table stats can be requested, and the controller can request statistics for specified flows, but that's it. This is a functionality which could be improved in future versions.

